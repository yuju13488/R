# 分群問題
### 距離計算
```{R}
x =c(0, 0, 1, 1, 1, 1)
y =c(1, 0, 1, 1, 0, 1)

#euclidean
?dist
rbind(x,y)

dist(rbind(x,y), method ="euclidean")
sqrt(sum((x-y)^2))
dist(rbind(x,y), method ="minkowski", p=2)

#city block
dist(rbind(x,y), method ="manhattan")
sum(abs(x-y))
dist(rbind(x,y), method ="minkowski", p=1)
```

### Hierarchical Clustering
### 聚合式(bottom-up)
```{R}
setwd('E:/R/riii')
customer=read.csv('E:/R/riii/data/customer.csv',header=TRUE)
head(customer)
str(customer)

#數值變數作正規化
customer_s =scale(customer[,-1])
?scale

#正規化後的變數平均數為0, 標準差為1
round(mean(customer_s[,2]),3)
round(sd(customer_s[,2]),3)

?hclust
hc=hclust(dist(customer_s, method="euclidean") #點與點衡量方式
          , method="ward.D2") #群與群衡量方式
plot(hc,hang =-0.01, cex=0.7)

hc3 =hclust(dist(customer, method="euclidean"), method="single")
plot(hc3, hang =-0.01, cex=0.8)
```

### cutree
```{R}
fit =cutree(hc, k =4)
fit
table(fit)
plot(hc, hang =-0.01, cex=0.7)
rect.hclust(hc, k =4, border="red")
rect.hclust(hc, k =3, border="blue")

c_1 = customer[fit == 1,]
summary(c_1)
```

### 分裂式階層式(top-down)
```{r}
#install.packages('cluster')
library(cluster)
?diana
dv =diana(customer_s, metric ="euclidean")
summary(dv)
plot(dv)

fit2 =cutree(dv,k=4)
c_1 = customer[fit2 ==2,]
summary(c_1)
```